import boto3
import botocore
from boto3.dynamodb.conditions import Attr


def scan_database(table, scan_kwargs=None):

    if scan_kwargs is None:
        scan_kwargs = {}
    dynamodb = boto3.resource('dynamodb',aws_access_key_id='AKIAVLFFKFZSR2PIHS2L', aws_secret_access_key='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', region_name='us-east-1')
    table = dynamodb.Table(table)

    complete = False
    records = []
    while not complete:
        try:
            response = table.scan(**scan_kwargs)
        except botocore.exceptions.ClientError as error:
            raise Exception('Error quering DB: {}'.format(error))

        records.extend(response.get('Items', []))
        next_key = response.get('LastEvaluatedKey')
        scan_kwargs['ExclusiveStartKey'] = next_key

        complete = True if next_key is None else False
    return records


if __name__ == '__main__':
    table_name = "employee"
    [print(i) for i in scan_database(table_name)]


if __name__ == '__main__':
table_name = "employee"
kwargs = {
      'FilterExpression': Attr("salary").eq(35007) &
                          Attr("id").begins_with('ppd_') &
                          Attr("dept").ne('Hr')
}
[print(i) for i in scan_database(table_name, kwargs)]